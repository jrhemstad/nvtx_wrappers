<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>NVTX++: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NVTX++
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">C++ convenience wrappers for NVTX.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">NVTX++ Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#Overview">Overview</a></li>
<li class="level1"><a href="#RANGES">Ranges</a><ul><li class="level2"><a href="#THREAD_RANGE">Thread Range</a></li>
<li class="level2"><a href="#PROCESS_RANGE">Process Range</a></li>
</ul>
</li>
<li class="level1"><a href="#DOMAINS">Domains</a></li>
<li class="level1"><a href="#ATTRIBUTES">Event Attributes</a><ul><li class="level2"><a href="#MESSAGES">Message</a><ul><li class="level3"><a href="#REGISTERED_MESSAGE">Registered Messages</a></li>
</ul>
</li>
<li class="level2"><a href="#COLOR">Color</a></li>
<li class="level2"><a href="#CATEGORY">Category</a><ul><li class="level3"><a href="#NAMED_CATEGORIES">Named Categories</a></li>
</ul>
</li>
<li class="level2"><a href="#Payload">Payload</a></li>
</ul>
</li>
<li class="level1"><a href="#EXAMPLE">Example</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="Overview"></a>
Overview</h1>
<p>The NVTX library provides a set of functions for users to annotate their code to aid in performance profiling and optimization. These annotations provide information to tools like Nsight Systems to improve visualization of application timelines.</p>
<p><a class="el" href="index.html#RANGES">Ranges</a> are one of the most commonly used NVTX constructs for annotating a span of time. For example, imagine a user wanted to see every time a function, <code>my_function</code>, is called and how long it takes to execute. This can be accomplished with an NVTX range created on the entry to the function and terminated on return from <code>my_function</code> using the push/pop C APIs:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> my_function(...){</div><div class="line">   nvtxRangePushA(<span class="stringliteral">&quot;my_function&quot;</span>); <span class="comment">// Begins NVTX range</span></div><div class="line">   <span class="comment">// do work</span></div><div class="line">   nvtxRangePop(); <span class="comment">// Ends NVTX range</span></div><div class="line">}</div></div><!-- fragment --><p>One of the challenges with using the NVTX C API is that it requires manually terminating the end of the range with <code>nvtxRangePop</code>. This can be challenging if <code>my_function()</code> has multiple returns or can throw exceptions as it requires calling <code>nvtxRangePop()</code> before all possible return points.</p>
<p>NVTX++ solves this inconvenience through the "RAII" technique by providing a <code>nvtx::thread_range</code> class that begins a range at construction and ends the range on destruction. The above example then becomes:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> my_function(...){</div><div class="line">   <a class="code" href="classnvtx_1_1domain__thread__range.html">nvtx::thread_range</a> r{<span class="stringliteral">&quot;my_function&quot;</span>}; <span class="comment">// Begins NVTX range</span></div><div class="line">   <span class="comment">// do work</span></div><div class="line">} <span class="comment">// Range ends on exit from `my_function` when `r` is destroyed</span></div></div><!-- fragment --><p>The range object <code>r</code> is deterministically destroyed whenever <code>my_function</code> returns&mdash;ending the NVTX range without manual intervention. For more information, see <a class="el" href="index.html#RANGES">Ranges</a> and <code><a class="el" href="classnvtx_1_1domain__thread__range.html" title="A RAII object for creating a NVTX range local to a thread within a domain. ">nvtx::domain_thread_range</a></code>.</p>
<p>Another inconvenience of the NVTX C APIs are the several constructs where the user is expected to initialize an object at the beginning of an application and reuse that object throughout the lifetime of the application. For example Domains, Categories, and Registered messages.</p>
<p>Example: </p><div class="fragment"><div class="line">nvtxDomainHandle_t D = nvtxDomainCreateA(<span class="stringliteral">&quot;my domain&quot;</span>);</div><div class="line"><span class="comment">// Reuse `D` throughout the rest of the application</span></div></div><!-- fragment --><p>This can be problematic if the user application or library does not have an explicit initialization function called before all other functions to ensure that these long-lived objects are initialized before being used.</p>
<p>NVTX++ makes use of the "construct on first use" technique to alleviate this inconvenience. In short, a function local static object is constructed upon the first invocation of a function and returns a reference to that object on all future invocations. See the documentation for <code><a class="el" href="classnvtx_1_1RegisteredMessage.html" title="A message registered with NVTX. ">nvtx::RegisteredMessage</a></code>, <code><a class="el" href="classnvtx_1_1Domain.html" title="Domains allow for grouping NVTX events into a single scope to differentiate them from events in other...">nvtx::Domain</a></code>, <code><a class="el" href="classnvtx_1_1NamedCategory.html" title="A Category with an associated name string. ">nvtx::NamedCategory</a></code>, and <a href="https://isocpp.org/wiki/faq/ctors#static-init-order-on-first-use">https://isocpp.org/wiki/faq/ctors#static-init-order-on-first-use</a> for more information.</p>
<p>Using construct on first use, the above example becomes: </p><div class="fragment"><div class="line"><span class="keyword">struct </span>my_domain{ <span class="keyword">static</span> constexpr <span class="keywordtype">char</span> <span class="keyword">const</span>* name{<span class="stringliteral">&quot;my domain&quot;</span>}; };</div><div class="line"></div><div class="line"><span class="comment">// The first invocation of `Domain::get` for the type `my_domain` will</span></div><div class="line"><span class="comment">// construct a `nvtx::Domain` object and return a reference to it. Future</span></div><div class="line"><span class="comment">// invocations simply return a reference.</span></div><div class="line"><a class="code" href="classnvtx_1_1Domain.html">nvtx::Domain</a> <span class="keyword">const</span>&amp; D = nvtx::Domain::get&lt;my_domain&gt;();</div></div><!-- fragment --><p> For more information about NVTX and how it can be used, see <a href="https://docs.nvidia.com/cuda/profiler-users-guide/index.html#nvtx">https://docs.nvidia.com/cuda/profiler-users-guide/index.html#nvtx</a> and <a href="https://devblogs.nvidia.com/cuda-pro-tip-generate-custom-application-profile-timelines-nvtx/">https://devblogs.nvidia.com/cuda-pro-tip-generate-custom-application-profile-timelines-nvtx/</a> for more information.</p>
<h1><a class="anchor" id="RANGES"></a>
Ranges</h1>
<p>Ranges are used to describe a span of time during the execution of an application. Common examples are using ranges to annotate the time it takes to execute a function or an iteration of a loop.</p>
<p>NVTX++ uses RAII to automate the generation of ranges that are tied to the lifetime of objects. Similar to <code>std::lock_guard</code> in the C++ Standard Template Library.</p>
<h2><a class="anchor" id="THREAD_RANGE"></a>
Thread Range</h2>
<p><code><a class="el" href="classnvtx_1_1domain__thread__range.html" title="A RAII object for creating a NVTX range local to a thread within a domain. ">nvtx::domain_thread_range</a></code> is a class that begins a range upon construction and ends the range at destruction. This is one of the most commonly used constructs in NVTX++ and is useful for annotating spans of time on a particular thread. These ranges can be nested to arbitrary depths.</p>
<p><code>nvtx::thread_range</code> is an alias for a <code><a class="el" href="classnvtx_1_1domain__thread__range.html" title="A RAII object for creating a NVTX range local to a thread within a domain. ">nvtx::domain_thread_range</a></code> in the global NVTX domain. For more information about Domains, see <a class="el" href="index.html#DOMAINS">Domains</a>.</p>
<p>Various attributes of a range can be configured constructing a <code><a class="el" href="classnvtx_1_1domain__thread__range.html" title="A RAII object for creating a NVTX range local to a thread within a domain. ">nvtx::domain_thread_range</a></code> with a <code><a class="el" href="classnvtx_1_1EventAttributes.html" title="Describes the attributes of a NVTX event. ">nvtx::EventAttributes</a></code> object. For more information, see <a class="el" href="index.html#ATTRIBUTES">Event Attributes</a>.</p>
<p>Example:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> some_function(){</div><div class="line">   <span class="comment">// Creates a range for the duration of `some_function`</span></div><div class="line">   <a class="code" href="classnvtx_1_1domain__thread__range.html">nvtx::thread_range</a> r{};</div><div class="line"></div><div class="line">   <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div><div class="line">      <span class="comment">// Creates a range for every loop iteration</span></div><div class="line">      <span class="comment">// `loop_range` is nested inside `r`</span></div><div class="line">      <a class="code" href="classnvtx_1_1domain__thread__range.html">nvtx::thread_range</a> loop_range{};</div><div class="line">   }</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="PROCESS_RANGE"></a>
Process Range</h2>
<p><code><a class="el" href="classnvtx_1_1domain__process__range.html" title="A RAII object for creating a NVTX range within a domain that can be created and destroyed on differen...">nvtx::domain_process_range</a></code> is identical to <code><a class="el" href="classnvtx_1_1domain__thread__range.html" title="A RAII object for creating a NVTX range local to a thread within a domain. ">nvtx::domain_thread_range</a></code> with the exception that a <code>domain_process_range</code> can be created and destroyed on different threads. This is useful to annotate spans of time that can bridge multiple threads.</p>
<p><code><a class="el" href="classnvtx_1_1domain__thread__range.html" title="A RAII object for creating a NVTX range local to a thread within a domain. ">nvtx::domain_thread_range</a></code>s should be preferred unless one needs the ability to begin and end a range on different threads.</p>
<h1><a class="anchor" id="DOMAINS"></a>
Domains</h1>
<p>Similar to C++ namespaces, Domains allow for scoping NVTX events. By default, all NVTX events belong to the "global" domain. Libraries and applications should scope their events to use a custom domain to differentiate where the events originate from.</p>
<p>It is common for a library or application to have only a single domain and for the name of that domain to be known at compile time. Therefore, Domains in NVTX++ are represented by <em>tag types</em>.</p>
<p>For example, to define a custom domain, simply define a new concrete type (a <code>class</code> or <code>struct</code>) with a <code>static</code> member called <code>name</code> that contains the desired name of the domain.</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>my_domain{ <span class="keyword">static</span> constexpr <span class="keywordtype">char</span> <span class="keyword">const</span>* name{<span class="stringliteral">&quot;my domain&quot;</span>}; };</div></div><!-- fragment --><p>For any NVTX++ construct that can be scoped to a domain, the type <code>my_domain</code> can be passed as an explicit template argument to scope it to the custom domain.</p>
<p>The tag type <code><a class="el" href="structnvtx_1_1Domain_1_1global.html" title="Tag type for the &quot;global&quot; NVTX domain. ">nvtx::Domain::global</a></code> represents the global NVTX domain.</p>
<div class="fragment"><div class="line"><span class="comment">// By default, `domain_thread_range` belongs to the global domain</span></div><div class="line"><a class="code" href="classnvtx_1_1domain__thread__range.html">nvtx::domain_thread_range&lt;&gt;</a> r0{};</div><div class="line"></div><div class="line"><span class="comment">// Alias for a `domain_thread_range` in the global domain</span></div><div class="line"><a class="code" href="classnvtx_1_1domain__thread__range.html">nvtx::thread_range</a> r1{};</div><div class="line"></div><div class="line"><span class="comment">// `r` belongs to the custom domain</span></div><div class="line"><a class="code" href="classnvtx_1_1domain__thread__range.html">nvtx::domain_thread_range&lt;my_domain&gt;</a> r{};</div></div><!-- fragment --><p>When using a custom domain, it is reccomended to define type aliases for NVTX constructs in the custom domain. </p><div class="fragment"><div class="line"><span class="keyword">using</span> my_thread_range = <a class="code" href="classnvtx_1_1domain__thread__range.html">nvtx::domain_thread_range&lt;my_domain&gt;</a>;</div><div class="line"><span class="keyword">using</span> my_registered_message = <a class="code" href="classnvtx_1_1RegisteredMessage.html">nvtx::RegisteredMessage&lt;my_domain&gt;</a>;</div><div class="line"><span class="keyword">using</span> my_named_category = <a class="code" href="classnvtx_1_1NamedCategory.html">nvtx::NamedCategory&lt;my_domain&gt;</a>;</div></div><!-- fragment --><p>See <code><a class="el" href="classnvtx_1_1Domain.html" title="Domains allow for grouping NVTX events into a single scope to differentiate them from events in other...">nvtx::Domain</a></code> for more information.</p>
<h1><a class="anchor" id="ATTRIBUTES"></a>
Event Attributes</h1>
<p>NVTX events can be customized with various attributes to provide additional information (such as a custom message) or to control visualization of the event (such as the color used). These attributes can be specified per-event via a <code><a class="el" href="classnvtx_1_1EventAttributes.html" title="Describes the attributes of a NVTX event. ">nvtx::EventAttributes</a></code> object.</p>
<p>All attributes are optional and use default values if not specified.</p>
<h2><a class="anchor" id="MESSAGES"></a>
Message</h2>
<h3><a class="anchor" id="REGISTERED_MESSAGE"></a>
Registered Messages</h3>
<h2><a class="anchor" id="COLOR"></a>
Color</h2>
<h2><a class="anchor" id="CATEGORY"></a>
Category</h2>
<h3><a class="anchor" id="NAMED_CATEGORIES"></a>
Named Categories</h3>
<h2><a class="anchor" id="Payload"></a>
Payload</h2>
<h1><a class="anchor" id="EXAMPLE"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Define a custom domain tag type</span></div><div class="line"><span class="keyword">struct </span>my_domain{ <span class="keyword">static</span> constexpr <span class="keywordtype">char</span> <span class="keyword">const</span>* name{<span class="stringliteral">&quot;my domain&quot;</span>}; };</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
